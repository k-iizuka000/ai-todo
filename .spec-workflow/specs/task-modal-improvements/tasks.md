# タスクモーダル改善 - タスクリスト

## フェーズ1: タスク追加モーダルの修正

### T001: TagDropdownコンポーネントの修正
- **説明**: 登録済みタグのみを表示し、新規作成を無効化
- **ファイル**: `src/components/tag/TagDropdown.tsx`
- **作業内容**:
  - useTagStoreから登録済みタグを取得
  - allowCreateプロパティをfalseに設定
  - 選択可能なタグのフィルタリング実装
- **優先度**: HIGH
- **見積時間**: 1時間

### T002: TaskFormのタグ選択部分修正
- **説明**: タグ選択時の即座登録を防止
- **ファイル**: `src/components/task/TaskForm.tsx`
- **作業内容**:
  - TagSelectorのmode="dropdown"設定
  - allowCreate={false}の設定
  - タグ選択時の動作改善
- **優先度**: HIGH
- **見積時間**: 1時間

### T003: タグ複数選択機能の実装
- **説明**: 複数タグを選択してから登録可能にする
- **ファイル**: `src/components/tag/TagDropdown.tsx`
- **作業内容**:
  - handleTagSelect関数の修正
  - ドロップダウンを閉じない実装
  - 選択済みタグの表示改善
- **優先度**: HIGH
- **見積時間**: 1.5時間

## フェーズ2: タスク編集モーダルの修正

### T004: サブタスク即時反映機能の実装
- **説明**: サブタスク追加後の即座UI更新
- **ファイル**: `src/components/task/TaskDetailModal.tsx`, `src/components/task/TaskDetailView.tsx`
- **作業内容**:
  - ローカル状態管理の実装
  - handleSubtaskAdd関数の改善
  - useEffectでの同期処理
- **優先度**: HIGH
- **見積時間**: 2時間

### T005: 更新ボタンの追加
- **説明**: 明確な更新ボタンをモーダルに追加
- **ファイル**: `src/components/task/TaskDetailView.tsx`
- **作業内容**:
  - 更新ボタンコンポーネントの追加
  - 変更検知ロジックの実装
  - handleUpdate関数の実装
- **優先度**: HIGH
- **見積時間**: 1.5時間

### T006: CSS余白とデザインの改善
- **説明**: 適切な余白を追加しデザインを統一
- **ファイル**: `src/styles/task-modal.css` (新規作成)
- **作業内容**:
  - 共通CSSクラスの作成
  - padding/marginの調整
  - /dashboard/demoを参考にしたスタイル適用
- **優先度**: MEDIUM
- **見積時間**: 2時間

### T007: タグ選択動作の統一
- **説明**: 追加モーダルと編集モーダルのタグ選択動作を統一
- **ファイル**: `src/components/task/TaskDetailView.tsx`
- **作業内容**:
  - 共通セレクター設定の実装
  - TagSelectorプロパティの統一
  - 動作確認とテスト
- **優先度**: MEDIUM
- **見積時間**: 1時間

### T008: プロジェクト選択動作の統一
- **説明**: 追加モーダルと編集モーダルのプロジェクト選択動作を統一
- **ファイル**: `src/components/task/TaskDetailView.tsx`
- **作業内容**:
  - ProjectSelectorプロパティの統一
  - 選択動作の確認
  - エラーハンドリング
- **優先度**: MEDIUM
- **見積時間**: 1時間

## フェーズ3: 共通改善とテスト

### T009: エラーハンドリングの強化
- **説明**: タグ・プロジェクト選択時のエラー処理改善
- **ファイル**: `src/components/task/TaskForm.tsx`, `src/components/task/TaskDetailView.tsx`
- **作業内容**:
  - try-catchブロックの追加
  - エラーメッセージの表示
  - リトライ機能の実装
- **優先度**: MEDIUM
- **見積時間**: 1.5時間

### T010: パフォーマンス最適化
- **説明**: React.memo, useCallback, useMemoの適用
- **ファイル**: 各コンポーネントファイル
- **作業内容**:
  - 不要な再レンダリング防止
  - メモ化の実装
  - デバウンス処理の追加
- **優先度**: LOW
- **見積時間**: 1.5時間

### T011: ユニットテストの作成
- **説明**: タグ選択とサブタスク機能のテスト
- **ファイル**: `src/components/task/__tests__/`
- **作業内容**:
  - タグ選択機能のテスト作成
  - サブタスク追加のテスト作成
  - フォームバリデーションのテスト
- **優先度**: MEDIUM
- **見積時間**: 2時間

### T012: E2Eテストの実装
- **説明**: Playwrightを使用した統合テスト
- **ファイル**: `tests/e2e/task-modal.spec.ts`
- **作業内容**:
  - タスク作成フローのテスト
  - タスク編集フローのテスト
  - エラー処理のテスト
- **優先度**: LOW
- **見積時間**: 2時間

## 完了条件
1. ✅ タグプルダウンに既存タグのみ表示
2. ✅ 複数タグの選択・登録が可能
3. ✅ サブタスク登録後の即時反映
4. ✅ 更新ボタンの実装と動作
5. ✅ デザインの統一性確認
6. ✅ 全てのテストが通過

## 注意事項
- 各タスク完了後は必ずlintとtypecheckを実行
- Docker環境での動作確認を忘れずに
- プルリクエスト作成前に全体テストを実行