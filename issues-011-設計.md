# Issue 011: タスク管理画面のプロジェクト表示機能 - 設計書

## 概要
タスク管理画面の各タスクカードに紐づくプロジェクト情報を視覚的に分かりやすく表示する機能を実装する。

## 現状分析

### 既存の構造
1. **データモデル**
   - `Task`型に`projectId`フィールドが既存
   - `Project`型にプロジェクト情報（name, color, icon等）が定義済み
   - モックデータでタスクとプロジェクトの関連付けが実装済み

2. **コンポーネント構造**
   - `TaskCard`コンポーネント：タスクの基本情報を表示
   - `TaskCardCompact`コンポーネント：コンパクト版のタスク表示
   - `TagBadge`コンポーネント：タグのバッジ表示（参考実装）

3. **ストア構造**
   - `taskStore`：タスク管理のグローバル状態
   - プロジェクト情報の取得方法が未実装

## 技術的設計

### アーキテクチャ方針
1. **表示層とデータ層の分離**
   - プロジェクト情報の取得ロジックはカスタムフックで実装
   - 表示コンポーネントは純粋なUIコンポーネントとして実装
   
2. **パフォーマンス最適化**
   - プロジェクト情報のメモ化による再レンダリング抑制
   - プロジェクトストアの実装による効率的なデータ管理

3. **再利用性の確保**
   - プロジェクトバッジを独立コンポーネント化
   - 複数の表示モード（フル、コンパクト、アイコンのみ）対応

### 実装方針

#### 1. プロジェクトバッジコンポーネント設計
```typescript
interface ProjectBadgeProps {
  projectId?: string;
  size?: 'sm' | 'md' | 'lg';
  showIcon?: boolean;
  showName?: boolean;
  onClick?: (projectId: string) => void;
  variant?: 'default' | 'compact' | 'icon-only';
}
```

#### 2. プロジェクトストアの追加
- 既存のタスクストアパターンに従い、プロジェクト専用ストアを実装
- プロジェクト情報のキャッシング機能
- プロジェクトIDによる高速検索

#### 3. 表示位置とレイアウト
- タスクタイトル下部の優先度バッジと同じ行に配置
- カラーはプロジェクトのテーマカラーを使用
- アイコン + プロジェクト名の組み合わせ表示

## 実装グループ

## グループ1: プロジェクトストアの実装 [@Phase1]
- プロジェクト管理用のZustandストア作成
- プロジェクトデータのCRUD操作実装
- プロジェクト情報の取得ヘルパーメソッド

## グループ2: プロジェクトバッジコンポーネントの作成 [@Phase1]
- `ProjectBadge`コンポーネントの新規作成
- 表示バリエーション（フル、コンパクト、アイコンのみ）の実装
- カラーとアイコンの動的表示

## グループ3: TaskCardへのプロジェクト表示統合 [@Phase1]
- `TaskCard`コンポーネントへのプロジェクトバッジ組み込み
- `TaskCardCompact`コンポーネントへの対応
- レイアウトの調整と最適化

## グループ4: カンバンボードでの表示確認 [@Phase1]
- KanbanBoardでのプロジェクト表示動作確認
- 各カラムでの表示一貫性確保
- ドラッグ&ドロップ時の表示維持

## グループ5: プロジェクトフィルタリング機能
- プロジェクトによるタスクフィルタリング
- プロジェクトバッジクリック時のフィルタリング動作
- フィルター状態の視覚的フィードバック

## グループ6: プロジェクト未設定時の対応
- プロジェクト未設定タスクの表示方法
- デフォルトプロジェクトの設定機能
- 「プロジェクトなし」バッジの表示

## グループ7: パフォーマンス最適化
- React.memoによるコンポーネントの最適化
- プロジェクト情報のキャッシング実装
- 大量タスク表示時のパフォーマンステスト

## グループ8: アクセシビリティ対応
- プロジェクトバッジのARIA属性追加
- キーボードナビゲーション対応
- スクリーンリーダー対応

## グループ9: レスポンシブデザイン対応
- モバイル表示時のプロジェクトバッジ表示
- タブレット表示の最適化
- 表示モードの自動切り替え

## グループ10: テスト実装
- プロジェクトバッジコンポーネントのユニットテスト
- TaskCardとの統合テスト
- E2Eテストシナリオの作成

## 実装詳細

### プロジェクトバッジの表示仕様
1. **カラー**: プロジェクトに設定されたテーマカラーを背景色として使用
2. **アイコン**: プロジェクトアイコン（絵文字）を左側に表示
3. **テキスト**: プロジェクト名を表示（最大文字数制限あり）
4. **インタラクション**: ホバー時にツールチップでフル名表示

### 優先度の考慮事項
1. タスクカード内の情報密度のバランス
2. 既存のタグバッジとの視覚的な差別化
3. カラーコントラストのアクセシビリティ基準準拠

### エラーハンドリング
1. プロジェクトIDが無効な場合の処理
2. プロジェクト情報取得失敗時のフォールバック表示
3. プロジェクトが削除された場合の対応

## 成功基準
- [ ] 各タスクカードにプロジェクト情報が表示される
- [ ] プロジェクトのカラーとアイコンが正しく表示される
- [ ] 既存のレイアウトを崩さずに統合される
- [ ] パフォーマンスの劣化がない
- [ ] モバイル表示でも適切に表示される

## リスクと対策
| リスク | 影響度 | 対策 |
|--------|--------|------|
| カード内の情報過多 | 中 | コンパクトモードでの表示制御 |
| パフォーマンス低下 | 高 | メモ化とキャッシング実装 |
| カラーコントラスト不足 | 中 | 自動コントラスト調整機能 |

## 今後の拡張可能性
1. プロジェクト別のタスク集計表示
2. プロジェクト切り替えドロップダウン
3. プロジェクトタイムライン表示
4. プロジェクト間のタスク移動機能